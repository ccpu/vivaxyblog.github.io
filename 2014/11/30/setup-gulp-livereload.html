<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <link rel="shortcut icon" href="/css/vivaxy.icon.png">
    <link type="text/css" rel="stylesheet" href="/css/reset.css">
    <link type="text/css" rel="stylesheet" href="/css/main.css">
    <link type="text/css" rel="stylesheet" href="/css/syntax.css">
    <title>Setup Gulp Livereload</title>
</head>
<body>
<div class="container">
    <a href="/" class="card hover-left">
	<div class="content">
		<h1>Setup Gulp Livereload</h1>
		<div class="date">2014-11-30</div>
	</div>
	<div class="icon-arrow-left"></div>
</a>
<div class="card">
	<div class="content">
		<h2 id="gulp">Gulp</h2>

<p><a href="http://gulpjs.com/">Gulp</a> is a new build tool for web developers.</p>

<h2 id="livereload">Livereload</h2>

<p><a href="http://livereload.com/">Livereload</a> can reload pages when changes detected.</p>

<p><a href="https://www.npmjs.org/package/grunt-livereload">Grunt livereload</a>.</p>

<h2 id="install-gulp-livereload">Install gulp livereload</h2>

<ol>
  <li>
    <p>Install chrome extension. <a href="https://chrome.google.com/webstore/detail/livereload/jnihajbhpnppcggbcgedagnkighmdlei">link</a></p>
  </li>
  <li>
    <p>Install npm module. <code>npm install --save-dev gulp-livereload</code></p>
  </li>
</ol>

<h2 id="setup-livereload-with-gulp-watch">Setup livereload with gulp watch</h2>

<ol>
  <li>Edit gulpfile.js</li>
</ol>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// import gulp</span>
<span class="kd">var</span> <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp&#39;</span><span class="p">);</span>
<span class="c1">// import some module else</span>
<span class="kd">var</span> <span class="nx">shell</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp-shell&#39;</span><span class="p">);</span>
<span class="c1">// import livereload</span>
<span class="kd">var</span> <span class="nx">livereload</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;gulp-livereload&#39;</span><span class="p">);</span>
<span class="c1">// set path</span>
<span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;src/*&#39;</span><span class="p">,</span>
    <span class="nx">des</span><span class="o">:</span> <span class="s1">&#39;bin-debug/*/*.js&#39;</span>
<span class="p">};</span>
<span class="c1">// set build task</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;build&#39;</span><span class="p">,</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;egret build&#39;</span><span class="p">));</span>
<span class="c1">// set watch task</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;watch&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// when files in paths.src changed, build task will be triggered</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">src</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;build&#39;</span><span class="p">]);</span>
    <span class="c1">// start livereload listener</span>
    <span class="c1">// a server will be started, livereload chrome extension will connect this server.</span>
    <span class="nx">livereload</span><span class="p">.</span><span class="nx">listen</span><span class="p">();</span>
    <span class="c1">// when files in paths.des changed, trigger livereload, and this will trigger reload on chrome pages</span>
    <span class="c1">// here we don&#39;t use source files, because typescript changes need to be compiled to javascript, then changes take effect</span>
    <span class="nx">gulp</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">des</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="nx">livereload</span><span class="p">.</span><span class="nx">changed</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// set server task</span>
<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;run&#39;</span><span class="p">,</span> <span class="nx">shell</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;egret startserver&#39;</span><span class="p">));</span></code></pre></div>

<ol>
  <li>
    <p>Open pages in chrome.</p>
  </li>
  <li>
    <p>Click livereload extension, and when the hollow circle becomes solid, it works.</p>
  </li>
  <li>
    <p>Now we edit some files, save it, pages reload automatically! WebStorm will save file auto, so changes take effect when typing.</p>
  </li>
</ol>

<h2 id="example">Example</h2>

<p><a href="http://github.com/vivaxy/eliminate/">http://github.com/vivaxy/eliminate/</a></p>

<h2 id="problems">Problems</h2>

<p>When destination files compiled one by one, livereload will be triggered each time! How to solve it?</p>

<h2 id="reference">Reference</h2>

<p><a href="https://www.npmjs.org/package/gulp-livereload">Gulp Livereload</a></p>


	</div>
</div>
<div class="card">
	<!-- 多说 start -->
	<div class="ds-thread" data-title="Setup Gulp Livereload" data-url=""></div>
	<script type="text/javascript" charset="utf-8" src="/js/duoshuo/duoshuo.js"></script>
	<!-- 多说  end  -->
</div>

    <a href="javascript:document.body.scrollIntoView(true);" class="card hover-top">
        <div class="content">
            <div class="date">© Copyright 2015 by vivaxy</div>
            <!--<div class="alipay"></div>-->
        </div>
    </a>
</div>
</body>
<script type="text/javascript" charset="utf-8" src="/js/analysis/ba.js"></script>
</html>
